(function(){"use strict";Window.App={},Window.App.Models={},Window.App.Views={},_.extend(Backbone.Model.prototype,Backbone.Validation.mixin)}).call(this),function(){"use strict";Window.App.Models.SaleDataModel=Backbone.Epoxy.Model.extend({defaults:{starName:"",starSize:"",starConstellation:"",firstName:"",lastName:"",patronymic:"",birthdate:"",sex:"",country:"",phone:"",email:""},computeds:{fullName:function(){return this.get("lastName")+" "+this.get("firstName")+" "+this.get("patronymic")}},validation:{starName:{required:!0,msg:"Введите имя звезды"},starSize:{required:!0,msg:"Выберите величину звезды"},starConstellation:{required:!0,msg:"Выберите созвездие"},firstName:{required:!0,msg:"Введите имя"},lastName:{required:!0,msg:"Введите фамилию"},patronymic:{required:!0,msg:"Введите отчество"},birthdate:function(t,e,a){var i,s,r,n,o;return t&&t.match(/^\d{2}\.\d{2}\.\d{4}$/)?(n=t.split("."),i=+n[0],s=+n[1],r=+n[2],o=new Date(r,s-1,i),+o.getDate()!==i?"Некорректный день рождения":+o.getMonth()+1!==s?"Некорректный месяц рождения":+o.getFullYear()!==r?"Некорректный год рождения":void 0):"Формат даты - дд.мм.гггг"},sex:{required:!0,msg:"Выберите пол"},country:{required:!0,msg:"Выберите страну"},phone:{required:!1,pattern:/^\+7 \(\d{3}\) \d{3}-\d{2}-\d{2}$/},email:{required:!1,pattern:"email"}},submit:function(){return localStorage.setItem("SaleData",this.attributes)}})}.call(this),function(){"use strict";Window.App.Views.SaleFormView=MixinBackbone(Backbone.Epoxy.View).extend({el:this.$("[data-js-sale-form]"),template:"#saleForm",events:{"input input":"onChangeData","change select":"onChangeData","blur input,select":"onChangeData","submit form":"onSubmit"},render:function(){return this.$("[data-js-attr=birthdate]").mask("99.99.9999"),this.$("[data-js-attr=phone]").mask("+7 (999) 999-99-99")},onChangeData:function(t){var e,a,i,s,r;return e=this.$(t.currentTarget),a=this.$(t.currentTarget).siblings("[data-js-attr-validation-error]"),i=e.attr("data-js-attr"),s=e.is("[type=radio]")&&!e.prop("checked")?"":e.val(),r=this.model.preValidate(i,s),a.html(r),r?void 0:this.model.set(i,s)},onSubmit:function(t){var e,a,i;if(e=this.$(t.currentTarget).find("[data-js-submit-validation-error]"),i=this.model.validate()){for(a in i)$("[data-js-attr="+a+"]").siblings("[data-js-attr-validation-error]").addClass("__fault").html(i[a]);return e.addClass("__fault").html("Не все поля корректно заполнены")}return this.model.submit(),e.removeClass("__fault").html("Успешно сохранено")}})}.call(this),function(){"use strict";Window.App.Views.SaleDocumentView=MixinBackbone(Backbone.Epoxy.View).extend({el:this.$("[data-js-sale-document]"),template:"#saleDocument",ui:{starName:"[data-js-star-name]",starSize:"[data-js-star-size]",starConstellation:"[data-js-star-constellation]",fullName:"[data-js-fullname]",birthdate:"[data-js-birthdate]",sex:"[data-js-sex]",country:"[data-js-country]",phone:"[data-js-phone]",email:"[data-js-email]"},bindings:{"@ui.starName":"text: starName","@ui.starSize":"text: starSize","@ui.starConstellation":"text: starConstellation","@ui.fullName":"text: fullName","@ui.birthdate":"text: birthdate","@ui.sex":"text: sex","@ui.country":"text: country","@ui.phone":"text: phone","@ui.email":"text: email"}})}.call(this),function(){"use strict";var t,e,a;t=new Window.App.Models.SaleDataModel,e=new Window.App.Views.SaleDocumentView({model:t}),a=new Window.App.Views.SaleFormView({model:t}),e.render(),a.render()}.call(this);