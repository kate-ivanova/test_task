(function(){"use strict";Window.App={},Window.App.Models={},Window.App.Views={},_.extend(Backbone.Model.prototype,Backbone.Validation.mixin)}).call(this),function(){"use strict";Window.App.Models.SaleDataModel=Backbone.Model.extend({defaults:{starName:"",starSize:"",starConstellation:"",firstName:"",lastName:"",patronymic:"",birthdate:"",sex:"",country:"",phone:"",email:""},validation:{starName:{required:!0,msg:"Введите имя звезды"},starSize:{required:!0,msg:"Выберите величину звезды"},starConstellation:{required:!0,msg:"Выберите созвездие"},firstName:{required:!0,msg:"Введите имя"},lastName:{required:!0,msg:"Введите фамилию"},patronymic:{required:!0,msg:"Введите отчество"},birthdate:function(t,e,a){var i,s,r,l,n;return t&&t.match(/^\d{2}\.\d{2}\.\d{4}$/)?(l=t.split("."),i=+l[0],s=+l[1],r=+l[2],n=new Date(r,s-1,i),+n.getDate()!==i?"Некорректный день рождения":+n.getMonth()+1!==s?"Некорректный месяц рождения":+n.getFullYear()!==r?"Некорректный год рождения":void 0):"Формат даты - дд.мм.гггг"},sex:{required:!0,msg:"Выберите пол"},country:{required:!0,msg:"Выберите страну"},phone:{required:!1,pattern:/^\+7 \(\d{3}\) \d{3}-\d{2}-\d{2}$/},email:{required:!1,pattern:"email"}},submit:function(){return localStorage.setItem("SaleData",this.attributes)}})}.call(this),function(){"use strict";Window.App.Views.SaleFormView=Backbone.View.extend({el:this.$(".sale-form"),template:_.template(this.$("#saleForm").html()),events:{"input input":"onInput","change select":"setModelAttr","blur input,select":"setModelAttr","submit form":"submit"},render:function(){return this.$el.html(this.template),this.$("[data-js-attr=birthdate]").mask("99.99.9999"),this.$("[data-js-attr=phone]").mask("+7 (999) 999-99-99")},setModelAttr:function(t){var e,a,i,s,r;return e=this.$(t.currentTarget),a=this.$(t.currentTarget).siblings("[data-js-attr-validation]"),i=e.attr("data-js-attr"),s=e.is("[type=radio]")&&!e.prop("checked")?"":e.val(),r=this.model.preValidate(i,s),r?changedFieldValid.addClass("__fault").html(validation):(changedFieldValid.removeClass("__fault").html(""),this.model.set(changedFieldName,changedFieldVal))},submit:function(t){var e,a,i;if(e=this.$(t.currentTarget).find("[data-js-submit-validation]"),i=this.model.validate()){for(a in i)$("[data-js-attr="+a+"]").siblings("[data-js-attr-validation]").addClass("__fault").html(i[a]);return e.addClass("__fault").html("Не все поля корректно заполнены")}return this.model.submit(),e.removeClass("__fault").html("Успешно сохранено")}})}.call(this),function(){"use strict";Window.App.Views.SaleDocumentView=Backbone.View.extend({el:$(".sale-document"),template:_.template($("#saleDocument").html()),initialize:function(){return this.listenTo(this.model,"change",this.render)},render:function(){return this.$el.html(this.template(this.model.toJSON()))}})}.call(this),function(){"use strict";var t,e,a;t=new Window.App.Models.SaleDataModel,e=new Window.App.Views.SaleDocumentView({model:t}),a=new Window.App.Views.SaleFormView({model:t}),e.render(),a.render()}.call(this);